<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ðŸ§  Cyber Safety Awareness Mini-Quiz</title>

  <!-- Fonts (Outfit + Poppins) -->
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@500;600;700&family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <!-- Global shared styles (gradient, nav, footer) -->
  <link rel="stylesheet" href="global.css">

  <style>
    /* ====== Quiz page specific styles ====== */
    :root{
      --card-w: 760px;
      --accent: #0d47a1;
      --muted: #6b7280;
      --bg-card: rgba(255,255,255,0.94);
    }
    body { font-family: 'Poppins', sans-serif; }

    /* page layout */
    .container { max-width: 1100px; margin: 30px auto 80px; padding: 0 18px; }

    .quiz-header {
      text-align: center;
      margin-top: 26px;
      margin-bottom: 6px;
    }
    .quiz-header h1 {
      font-family: 'Outfit', sans-serif;
      font-size: 2.2rem;
      color: var(--accent);
      margin-bottom: 6px;
    }
    .quiz-header p { color: var(--muted); font-size: 1rem; margin-bottom: 18px; }

    /* deck area */
    .deck {
      display:flex;
      justify-content:center;
      align-items:center;
      min-height: 360px;
      margin: 18px 0 10px;
      position: relative;
      perspective: 1400px;
    }

    /* card */
    .card {
      width: min(var(--card-w), 94%);
      max-width: var(--card-w);
      background: var(--bg-card);
      border-radius: 14px;
      padding: 28px;
      box-shadow: 0 18px 40px rgba(6,24,54,0.12);
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      flex-direction: column;
      gap: 16px;
      will-change: transform, opacity;
    }

    /* stacked deck effect: earlier cards are slightly scaled/rotated */
    .stacked[data-depth="0"]{ transform: translateX(-50%) translateY(0) scale(1); z-index: 60; }
    .stacked[data-depth="1"]{ transform: translateX(-48%) translateY(6px) scale(.985) rotate(-1deg); z-index: 55;}
    .stacked[data-depth="2"]{ transform: translateX(-52%) translateY(12px) scale(.97) rotate(1deg); z-index: 50;}
    .stacked[data-depth="3"]{ transform: translateX(-46%) translateY(18px) scale(.955) rotate(-1.5deg); z-index: 45;}

    /* intro card title */
    .card .title {
      display:flex;align-items:center;gap:12px;
      font-family: 'Outfit', sans-serif;
      font-size: 1.35rem;
      color: var(--accent);
    }

    .card p { color: #213547; font-size: 1rem; line-height:1.45; }

    /* question text */
    .question-text {
      font-family: 'Outfit', sans-serif;
      font-size: 1.18rem;
      color: #07224a;
    }

    /* options */
    .options { display:flex; flex-direction:column; gap:10px; margin-top:6px; }
    .option {
      display:flex; gap:12px; align-items:center;
      border-radius:10px; padding:12px 14px;
      background: rgba(13,71,161,0.04);
      cursor:pointer; border: 1px solid rgba(13,71,161,0.06);
      transition: transform .16s ease, box-shadow .16s ease, background .16s ease;
      user-select: none;
    }
    .option:hover { transform: translateY(-4px); box-shadow: 0 8px 18px rgba(13,71,161,0.08); }
    .option.selected { background: rgba(13,71,161,0.12); border-color: rgba(13,71,161,0.18); }

    .option .letter {
      width:34px;height:34px;border-radius:8px;
      display:flex;align-items:center;justify-content:center;
      font-weight:700;color:var(--accent); background:#fff;border:1px solid rgba(13,71,161,0.08);
    }
    .option .label { color:#08325a; font-weight:600; }

    /* image options (simple) */
    .img-choice { display:flex; gap:14px; justify-content:center; margin-top:10px; }
    .img-box {
      width:210px; height:90px; border-radius:10px; display:flex; align-items:center; justify-content:center;
      flex-direction:column; gap:6px; padding:12px;
      background:#ffffff; border:1px solid rgba(13,71,161,0.06);
      cursor:pointer;
    }
    .img-box .url { font-family:'Poppins'; font-size:0.95rem; color:#08325a; margin-top:4px; }

    /* bottom controls */
    .controls { display:flex; justify-content:space-between; align-items:center; gap:10px; margin-top:12px; }
    .controls .left { display:flex; gap:10px; }
    button.btn {
      background: var(--accent); color:white; border:none; padding:10px 16px; border-radius:10px; font-weight:700; cursor:pointer;
      box-shadow: 0 8px 20px rgba(13,71,161,0.12);
      transition: transform .12s ease;
    }
    button.btn.secondary { background: transparent; color: var(--accent); border: 1.5px solid rgba(13,71,161,0.12); }
    button.btn:active { transform: translateY(2px); }

    .skip-btn { background: transparent; color:var(--accent); border: none; font-weight:700; cursor:pointer; }

    /* feedback tag */
    .feedback { font-weight:700; color: #0d7a2b; margin-top:10px; }

    /* progress */
    .progress {
      display:flex; align-items:center; gap:8px; color:var(--muted); font-size:0.95rem;
    }

    .pager {
      display:flex; gap:8px; align-items:center;
    }

    /* final screen */
    .result {
      text-align:center;
      padding: 6px 12px 18px;
    }
    .result h2 { font-family: 'Outfit'; color:var(--accent); font-size:1.6rem; margin-bottom:8px; }
    .result p { color:#16324a; margin-bottom:8px; font-weight:600; }

    /* small screens */
    @media (max-width:720px){
      :root{ --card-w: 92vw; }
      .img-box { width: 44vw; height: 86px; }
    }
  </style>
</head>

<body>
  <!-- NAV (uses your global .glass-nav style) -->
  <nav class="glass-nav">
    <div class="nav-left">Hi, Welcome to your Cyber Safety Guide!</div>
    <div class="nav-right">
      <a href="index.html">Home</a>
      <a href="about.html">About</a>
      <a href="threats.html">Threats</a>
      <a href="help.html">Help</a>
      <a href="stats.html">Stats</a>
      <a href="tools.html">Tools</a>
      <a href="quiz.html" class="active">Quiz</a>
      <a href="faq.html">FAQ's</a>
    </div>
  </nav>

  <main class="container">
    <header class="quiz-header">
      <h1>ðŸ§  Cyber Safety Awareness Mini-Quiz</h1>
      <p>One question at a time. Friendly score feedback at the end. Ready to test your cyber smarts?</p>
    </header>

    <div class="deck" id="deck" aria-live="polite">
      <!-- cards are injected by JS -->
    </div>

    <div style="text-align:center; margin-top:18px; color:var(--muted); font-size:0.95rem">
      Tip: Use <strong>Submit</strong> to lock an answer, or <strong>Skip</strong> to move on without points.
    </div>
  </main>

  <!-- footer (uses global footer style) -->
  <footer style="margin-top:40px;">
    <p class="footer-quote">"Small steps = big protection."</p>
    <p class="footer-credit">Credit â€” Vaibhav Raj | Class IX | Sunbeam School Babatpur</p>
  </footer>

<script>
/* ===== Quiz data (ordered: Intro card then 8 questions) ===== */
const cards = [
  // Intro card
  {
    type: 'intro',
    title: "ðŸ§  Cyber Safety Awareness Mini-Quiz",
    body: `Instructions:
Choose the correct option for each question.
Each correct answer = 1 point.
At the end, total your score and check what your â€œCyber Awareness Levelâ€ says about you.`,
    cta: "Let's Go!"
  },

  // Q1
  {
    id:1, type:'mcq', q: "Which message is MOST likely a phishing scam?",
    opts: ["â€œYour timetable is updated.â€","â€œYour bank account is locked! Click here immediately.â€","â€œYour friend sent you a photo.â€","â€œPackage arriving tomorrow.â€"],
    answer: 1
  },

  // Q2
  {
    id:2, type:'mcq', q: "Which one is a strong password?",
    opts: ["MyPassword123","123456","Sunny2009","K!pa4R#92wQ"],
    answer: 3
  },

  // Q3
  {
    id:3, type:'mcq', q: "Which action can infect your device with malware?",
    opts: ["Downloading files from unknown websites","Updating your apps","Restarting your device","Charging your phone"],
    answer: 0
  },

  // Q4 - public wifi
  {
    id:4, type:'mcq', q: "What should you avoid doing on public Wi-Fi?",
    opts: ["Watching videos","Logging into banking/payment apps","Reading news articles","Checking the weather"],
    answer: 1
  },

  // Q5 - cyberbullying true/false
  {
    id:5, type:'tf', q: "Cyberbullying includes sending hurtful messages or spreading lies online.",
    opts: ["True","False"],
    answer: 0
  },

  // Q6 - data breach / password reuse tf
  {
    id:6, type:'tf', q: "Using the same password everywhere increases the damage if a data breach happens.",
    opts: ["True","False"],
    answer: 0
  },

  // Q7 - picture-based fake website
  {
    id:7, type:'pic', q: "Which website looks safer?",
    opts: [
      { label: "https://example.com", safe: true }, 
      { label: "http://exampIe.co", safe: false } // i replaced 'l' with 'I' to show weird spelling
    ],
    answer: 0
  },

  // Q8 - QR safety TF
  {
    id:8, type:'tf', q: "It's safe to scan any random QR code you find in public.",
    opts: ["True","False"],
    answer: 1
  }
];

/* ===== State ===== */
let order = [...Array(cards.length).keys()]; // indexes 0..N-1
// We'll shuffle the question cards (except keep intro at index 0)
const introIndex = 0;
let questionIndexes = order.slice(1);
function shuffle(a){
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]] = [a[j],a[i]];
  }
}
shuffle(questionIndexes);
order = [introIndex, ...questionIndexes];

let currentPos = 0;
let score = 0;
let userAnswers = Array(cards.length).fill(null);

/* ===== Render deck (stacked) ===== */
const deckEl = document.getElementById('deck');

function createCardElement(cardObj, depth){
  const card = document.createElement('article');
  card.className = 'card stacked';
  card.setAttribute('data-depth', depth);
  if(depth>3) card.style.display='none';

  // content
  if(cardObj.type==='intro'){
    card.innerHTML = `
      <div class="title"><i class="fa-solid fa-hand-point-right" style="color:var(--accent)"></i> ${cardObj.title}</div>
      <p style="white-space:pre-line">${cardObj.body}</p>
      <div style="display:flex;justify-content:center;margin-top:8px">
        <button class="btn" id="startBtn">${cardObj.cta}</button>
      </div>
    `;
    return card;
  }

  // question / mcq / tf / pic
  const qHtml = document.createElement('div');
  qHtml.innerHTML = `
    <div class="title"><i class="fa-solid fa-question-circle" style="color:var(--accent)"></i> Question ${currentPos}</div>
    <div class="question-text" id="qtext">${cardObj.q}</div>
  `;
  card.appendChild(qHtml);

  // options container
  const opts = document.createElement('div');
  opts.className = 'options';
  if(cardObj.type==='mcq'){
    cardObj.opts.forEach((opt, i) => {
      const op = document.createElement('div');
      op.className='option';
      op.dataset.index = i;
      op.innerHTML = `<div class="letter">${String.fromCharCode(65+i)}</div><div class="label">${opt}</div>`;
      op.addEventListener('click', ()=> selectOption(card, i));
      opts.appendChild(op);
    });
    card.appendChild(opts);
  } else if(cardObj.type==='tf'){
    cardObj.opts.forEach((opt, i) => {
      const op = document.createElement('div');
      op.className='option';
      op.dataset.index = i;
      op.innerHTML = `<div class="letter">${String.fromCharCode(65+i)}</div><div class="label">${opt}</div>`;
      op.addEventListener('click', ()=> selectOption(card, i));
      opts.appendChild(op);
    });
    card.appendChild(opts);
  } else if(cardObj.type==='pic'){
    const imgArea = document.createElement('div');
    imgArea.className = 'img-choice';
    cardObj.opts.forEach((option, i) => {
      const box = document.createElement('div');
      box.className = 'img-box';
      box.dataset.index = i;
      // simple visuals: padlock + url or warning
      if(option.safe){
        box.innerHTML = `<svg width="44" height="44" viewBox="0 0 24 24" fill="none" aria-hidden><path d="M12 1v4" stroke="#0d47a1" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/><rect x="4" y="7" width="16" height="12" rx="2" stroke="#0d47a1" stroke-width="1.6" fill="#eaf3ff"></rect><path d="M8 12h8" stroke="#0d47a1" stroke-width="1.6" stroke-linecap="round"/></svg>
          <div class="url">${option.label}</div>`;
      } else {
        box.innerHTML = `<svg width="44" height="44" viewBox="0 0 24 24" fill="none" aria-hidden><circle cx="12" cy="12" r="10" stroke="#ea6b6b" stroke-width="1.6" fill="#fff6f6"></circle><path d="M9 9l6 6M15 9l-6 6" stroke="#ea6b6b" stroke-width="1.6" stroke-linecap="round"/></svg>
          <div class="url">${option.label}</div>`;
      }
      box.addEventListener('click', ()=> selectOption(card, i));
      imgArea.appendChild(box);
    });
    card.appendChild(imgArea);
  }

  // controls & buttons
  const controls = document.createElement('div');
  controls.className = 'controls';

  // left group: skip
  const left = document.createElement('div');
  left.className='left';
  const skipBtn = document.createElement('button');
  skipBtn.className='btn secondary';
  skipBtn.textContent = 'Skip';
  skipBtn.addEventListener('click', ()=> handleSkip());
  left.appendChild(skipBtn);

  // right group: submit
  const submitBtn = document.createElement('button');
  submitBtn.className='btn';
  submitBtn.textContent = 'Submit';
  submitBtn.disabled = true;
  submitBtn.addEventListener('click', ()=> handleSubmit());
  controls.appendChild(left);
  controls.appendChild(submitBtn);

  // progress and place-holder feedback
  const progress = document.createElement('div');
  progress.className = 'progress';
  progress.innerHTML = `<div class="pager">Q ${Math.max(1, currentPos)} / ${cards.length-1}</div>`;

  const wrapper = document.createElement('div');
  wrapper.style.display='flex';
  wrapper.style.justifyContent='space-between';
  wrapper.style.alignItems='center';
  wrapper.style.marginTop='6px';
  wrapper.appendChild(progress);
  wrapper.appendChild(controls);

  card.appendChild(wrapper);

  // store refs in card
  card._submitBtn = submitBtn;
  card._optsContainer = opts || imgArea;
  card._cardObj = cardObj;
  card._selected = null;
  return card;
}

/* ===== deck initial render ===== */
function renderDeck(){
  deckEl.innerHTML='';
  // show up to 4 stacked cards for the deck illusion
  const maxDepth = Math.min(4, order.length - currentPos);
  for(let i=0;i<maxDepth;i++){
    const idx = order[currentPos + i];
    const cardObj = cards[idx];
    const el = createCardElement(cardObj, i);
    // initial entrance animation
    el.style.opacity = 0;
    deckEl.appendChild(el);
    requestAnimationFrame(()=> {
      el.style.transition = 'transform .6s cubic-bezier(.2,.9,.25,1), opacity .4s ease';
      el.style.opacity = 1;
      el.style.transform = getComputedStyle(el).transform; // trigger
    });
  }
  attachStartIfPresent();
}

function attachStartIfPresent(){
  const startBtn = document.getElementById('startBtn');
  if(startBtn){
    startBtn.addEventListener('click', ()=> {
      // jump to first question (advance currentPos)
      goNextCard();
    });
  }
}

/* ===== selection logic ===== */
function selectOption(cardEl, index){
  // clear selected classes
  const opts = cardEl._optsContainer.querySelectorAll('.option, .img-box');
  opts.forEach(o => o.classList.remove('selected'));
  // mark selected
  const chosen = Array.from(opts).find(el => el.dataset.index == index);
  if(!chosen) return;
  chosen.classList.add('selected');
  cardEl._selected = index;
  // enable submit
  cardEl._submitBtn.disabled = false;
}

/* ===== submit and skip handlers ===== */
function handleSubmit(){
  const topCard = deckEl.querySelector('.card');
  if(!topCard) return;
  const cardObj = topCard._cardObj;
  const selected = topCard._selected;
  if(selected === null || selected === undefined){
    // no selection - ignore
    return;
  }
  // check correctness
  const correct = cardObj.answer;
  const isCorrect = Number(selected) === Number(correct);
  if(isCorrect){
    score++;
    showFeedback(topCard, true);
  } else {
    showFeedback(topCard, false, cardObj);
  }
  // lock UI and advance after short delay
  topCard._submitBtn.disabled = true;
  setTimeout(()=> {
    // animate card away
    popTopCard();
  }, 850);
}

function handleSkip(){
  // just pop top card without scoring
  popTopCard();
}

function showFeedback(cardEl, ok, cardObj){
  // small feedback text
  let fb = document.createElement('div');
  fb.className = 'feedback';
  if(ok){
    fb.style.color = '#0d7a2b';
    fb.textContent = 'Nice! That was correct.';
  } else {
    fb.style.color = '#c0392b';
    if(cardObj){
      // show correct answer text (friendly)
      let ansText = '';
      if(cardObj.type === 'pic'){
        ansText = (cardObj.opts[cardObj.answer].label) || '';
      } else {
        ansText = cardObj.opts[cardObj.answer];
      }
      fb.textContent = `Not quite â€” correct answer: ${ansText}`;
    } else {
      fb.textContent = 'Not quite â€” keep going!';
    }
  }
  cardEl.appendChild(fb);
}

/* ===== card pop / transition logic ===== */
function popTopCard(){
  const top = deckEl.querySelector('.card');
  if(!top) return;
  // animate out: rotate and move
  top.style.transition = 'transform .6s cubic-bezier(.2,.9,.25,1), opacity .4s';
  top.style.transform = 'translateX(-140%) rotate(-24deg) translateY(-40px) scale(.98)';
  top.style.opacity = 0;
  // after anim, remove and advance
  setTimeout(()=> {
    // remove top element
    if(top && top.parentNode) top.parentNode.removeChild(top);
    currentPos++;
    // if done show results
    if(currentPos >= order.length){
      renderResults();
    } else {
      // render next card(s) - add one more to maintain stack depth
      const nextIndex = order[currentPos + Math.min(3, order.length)];
      renderDeck();
      // small shuffle-bounce when revealing next
      const newTop = deckEl.querySelector('.card');
      if(newTop){
        newTop.style.transform += ' translateY(-8px)';
        setTimeout(()=> newTop.style.transform = newTop.style.transform.replace(' translateY(-8px)',''), 260);
      }
    }
  }, 520);
}

/* ===== final results ===== */
function renderResults(){
  deckEl.innerHTML = '';
  const resCard = document.createElement('div');
  resCard.className = 'card';
  resCard.innerHTML = `
    <div class="result">
      <h2>ðŸŽ‰ Quiz Complete!</h2>
      <p>Your Score: <strong id="finalScore">${score}</strong> / ${cards.length-1}</p>
      <div id="levelText" style="margin-top:10px; font-size:1.03rem; color:#0b3b64;"></div>
      <div style="margin-top:18px;">
        <button class="btn" id="retryBtn">Try Again</button>
        <button class="btn secondary" id="shareBtn">Share Score</button>
      </div>
    </div>
  `;
  deckEl.appendChild(resCard);

  const lvl = document.getElementById('levelText');
  const pct = score;
  let msg = '';
  if(pct <= 2) msg = 'Be Careful Online! â€” You\'re getting started. Learn the basics and always double-check links.';
  else if(pct <=5) msg = 'Good Job, Keep Learning! â€” You know the basics. A bit more practice and you\'ll be safer.';
  else if(pct <=7) msg = 'Cyber-Smart! â€” Great work. You identify threats well.';
  else msg = 'Cyber Guardian! â€” Perfect score! Share tips with friends.';

  lvl.textContent = msg;

  // retry and share handlers
  document.getElementById('retryBtn').addEventListener('click', ()=> {
    // reset
    score = 0; currentPos = 0; userAnswers = Array(cards.length).fill(null);
    questionIndexes = [...Array(cards.length-1).keys()].map(i=> i+1);
    shuffle(questionIndexes);
    order = [introIndex, ...questionIndexes];
    renderDeck();
  });
  document.getElementById('shareBtn').addEventListener('click', ()=> {
    const text = `I scored ${score}/${cards.length-1} on the Cyber Safety Mini-Quiz!`;
    if(navigator.share){ navigator.share({title:'Cyber Quiz Score', text}); }
    else { navigator.clipboard.writeText(text).then(()=> alert('Score copied to clipboard!')); }
  });
}

/* ===== init ===== */
renderDeck();

// keyboard accessibility: Enter triggers submit if button exists
document.addEventListener('keydown', (e) => {
  if(e.key === 'Enter'){
    const top = deckEl.querySelector('.card');
    if(!top) return;
    const sb = top._submitBtn;
    if(sb && !sb.disabled) sb.click();
  }
});
</script>

</body>
</html>
